<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>新增配送点[档口+服务站平级模式] | Coderss</title>
    <meta name="author" content="coder">
    <meta name="version" content="1.0.0">
    <meta name="keywords" content="">
    <meta name="description" content="技术笔记">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="baidu-site-verification" content="F0CXvmUgA9">

    
    
    <link rel="icon" href="/favicon.png">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <div class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <button id="open-panel" class="open-panel"><i class="icon-library"></i></button>

    <nav class="nav-inner">

        
        
        <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/back-end">Java栈</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/cpp">C/C++</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/go">Golang</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/cloud">System</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/reverse">Reverse</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/data">BigData</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/ai">Math/AI</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/physical">Physical</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/life">生活规划</a>
        </li>
        
        
        
        <li class="nav-item nav-item-tag">
            <a id="nav-tag" class="nav-link" href="#">标签</a>
            <div id="nav-tags" class="nav-tag-wrap">
                <i class="nav-tag-arrow"></i>
                
  <div class="widget-wrap">
    <h3 class="widget-title">
        <i class="icon-tag vm"></i>
        <span class="vm">Tags</span>
    </h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Boost库/">Boost库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Collection/">Collection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cpp编程/">Cpp编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fescar/">Fescar</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gc/">Gc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/K8s/">K8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MapReduce/">MapReduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mesos/">Mesos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python计算库/">Python计算库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scikit/">Scikit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sharding-jdbc/">Sharding-jdbc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SkyWalking/">SkyWalking</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SofaMesh/">SofaMesh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark/">Spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TensorFlow/">TensorFlow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TroubleShoot/">TroubleShoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Turi/">Turi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows系统/">Windows系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows驱动/">Windows驱动</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yarn/">Yarn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/assembly/">assembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c-cpp语言/">c/cpp语言</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debug/">debug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eth/">eth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go-kernel/">go-kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/io/">io</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/juc/">juc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/map/">map</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mfc/">mfc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservice/">microservice</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netty/">netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python-book/">python-book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qt/">qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sentinel/">sentinel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/skycoin/">skycoin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-cloud/">spring-cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stl/">stl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/x64-Windows系统总结/">x64 Windows系统总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/x86-Windows系统总结/">x86 Windows系统总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/中台/">中台</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内网穿透/">内网穿透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式文件系统/">分布式文件系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程编程/">多线程编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/消息队列/">消息队列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络编程/">网络编程</a></li></ul>
    </div>
  </div>


            </div>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/archives">归档</a>
        </li>
        
        
        

    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://www.coderss.cn"></form>

        
        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#任务背景"><span class="toc-number">1.</span> <span class="toc-text">任务背景</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#现有物流调度模型"><span class="toc-number">1.1.</span> <span class="toc-text">现有物流调度模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#现有物流调度接口"><span class="toc-number">1.2.</span> <span class="toc-text">现有物流调度接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改方案"><span class="toc-number">1.3.</span> <span class="toc-text">修改方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#接口服务化"><span class="toc-number">1.3.1.</span> <span class="toc-text">接口服务化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#增加档口调度"><span class="toc-number">1.3.2.</span> <span class="toc-text">增加档口调度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PlatformManager"><span class="toc-number">1.3.3.</span> <span class="toc-text">PlatformManager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wms-service"><span class="toc-number">1.3.4.</span> <span class="toc-text">Wms-service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stock-service"><span class="toc-number">1.3.5.</span> <span class="toc-text">Stock-service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Logistics-service"><span class="toc-number">1.3.6.</span> <span class="toc-text">Logistics-service</span></a></li></ol></li></ol></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope="" itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            新增配送点[档口+服务站平级模式]
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="/stall-design/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-08-26T11:24:20.000Z" itemprop="datePublished">2019-08-26</time>
</a>

            

        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="任务背景"><a href="#任务背景" class="headerlink" title="任务背景"></a>任务背景</h1><p>PRD:<a href="https://share.mockplus.cn/go/ordersss/index.html" target="_blank" rel="noopener">https://share.mockplus.cn/go/ordersss/index.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">以基础物流调度模型为背景</span><br><span class="line">服务站作为各个途径点</span><br><span class="line">发起站为经销商(经销商承运)或中心仓(宋小菜承运)</span><br><span class="line"></span><br><span class="line">而档口只是作为服务站相关联的站点</span><br><span class="line">如今要以平级身份出现在调度途径点</span><br></pre></td></tr></table></figure>
<h2 id="现有物流调度模型"><a href="#现有物流调度模型" class="headerlink" title="现有物流调度模型"></a>现有物流调度模型</h2><p><img src="/stall-design/index/image-01.png" width="500px"></p>
<h2 id="现有物流调度接口"><a href="#现有物流调度接口" class="headerlink" title="现有物流调度接口"></a>现有物流调度接口</h2><table>
<thead>
<tr>
<th>接口地址</th>
<th>接口功能</th>
<th>所在项目</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>initCreateSchedulingByLocationId</code></td>
<td>起点拿各个途径点信息<br>以及途径点<code>SKU</code>模糊需求量</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>initStockByLocationIdAndSkuIds</code></td>
<td>拿途径点具体的<code>SKU</code>需求量</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>querySchedulingList.do</code></td>
<td>获取各个调度路线</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>createScheduling.do</code></td>
<td>调度单创建</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>updateScheduling.do</code></td>
<td>调度单更新</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>deliveryScheduling.do</code></td>
<td>调度单发车</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>rollBackScheduling.do</code></td>
<td>打回调度单</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>resetPassword.do</code></td>
<td>重制司机密码</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>returnToNotArrive.do</code></td>
<td>物流调度单,司机提前点到达站点<br>该卸货线路的状态由2变成1（未到达）</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>queryCanMergedSchedulingListById.do</code></td>
<td>根据物流单id查询有关可以合并的物流单</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>initCreateSkuScheduling.do</code></td>
<td>物流调度路线-SKU视图-创建线路初始化-接口</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>initCreatePickhouseScheduling.do</code></td>
<td>物流调度路线-站点视图-创建线路初始化-接口</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>initUpdatePickhouseScheduling.do</code></td>
<td>物流调度路线-站点视图-编辑线路初始化-接口</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>querySchedulingPickhouseDetail.do</code></td>
<td>物流调度路线-站点视图-详情-接口</td>
<td><code>PlatformManager</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.query.logistic.detail</code></td>
<td>获取调度线详情</td>
<td><code>logistics-center</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.query.dispatch.detail</code></td>
<td>获取精准调度单详情</td>
<td><code>logistics-center</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.merge.schedul</code></td>
<td>合并成精准调度单</td>
<td><code>logistics-center</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.cancelMerge.dispatch</code></td>
<td>取消合并精准调度单</td>
<td><code>logistics-center</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.schdulingroute.deliveryFee.edit</code></td>
<td>草稿物流单杂费录入</td>
<td><code>logistics-center</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.dispatch.deliveryFee.edit</code></td>
<td>编辑精准物流单费用</td>
<td><code>logistics-center</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.scheduling.merged.check</code></td>
<td>检查草稿物流单是否已经清洗</td>
<td><code>logistics-center</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.query.scheduling.position</code></td>
<td>根据调度单id查线路</td>
<td><code>logistics-center</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>额外接口</p>
</blockquote>
<table>
<thead>
<tr>
<th>接口地址</th>
<th>接口功能</th>
<th>所在项目</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>songxiaocai.logisticsservice.driverAndCar.page.query</code></td>
<td>司机检索</td>
<td><code>logistics-center</code></td>
</tr>
<tr>
<td><code>songxiaocai.logisticsservice.driverAndCar.getById</code></td>
<td>司机旗下车子检索</td>
<td><code>logistics-center</code></td>
</tr>
</tbody>
</table>
<p><br><br><br></p>
<h2 id="修改方案"><a href="#修改方案" class="headerlink" title="修改方案"></a>修改方案</h2><h3 id="接口服务化"><a href="#接口服务化" class="headerlink" title="接口服务化"></a>接口服务化</h3><p>相关<code>PlatformManager</code>项目相关的代码转移<code>LogisiticService</code>项目上</p>
<p><br></p>
<h3 id="增加档口调度"><a href="#增加档口调度" class="headerlink" title="增加档口调度"></a>增加档口调度</h3><blockquote>
<p>流程图观望</p>
</blockquote>
<p><img src="/stall-design/index/image-02.jpg" width="500px"></p>
<blockquote>
<p>数据库变更  </p>
</blockquote>
<p><code>sxc_wms_warehouse</code>新增<code>warehouse_type</code>区分<code>服务站|0</code>,<code>档口|1</code>,默认<code>服务站|0</code></p>
<p><br></p>
<h3 id="PlatformManager"><a href="#PlatformManager" class="headerlink" title="PlatformManager"></a>PlatformManager</h3><blockquote>
<p>服务站物流单创建模式  </p>
</blockquote>
<p><code>deliveryOrder</code>: 起点拿各个途径点信息以及途径点SKU模糊需求量 会用到<code>delivery_order</code>用来组装<code>skuNeedDeliveryInfoDTOS</code></p>
<p>有以下操作:</p>
<ul>
<li><code>pickConfirm</code>用户提货操作 </li>
<li><code>createOrder</code>,<code>updateOrderPay</code>用户购买订单操作  </li>
</ul>
<p>档口模式？</p>
<ul>
<li>修改<code>initCreateSchedulingByLocationId</code><br>兼容<code>服务站的用户买</code> 和 <code>档口的管理买</code>的sku模糊需求量</li>
</ul>
<p><br></p>
<h3 id="Wms-service"><a href="#Wms-service" class="headerlink" title="Wms-service"></a>Wms-service</h3><blockquote>
<p>创建档口-同步档口信息 </p>
</blockquote>
<p><code>registerWarehouse</code>,获取档口的模式下<code>warehouse_type</code>为<code>档口|1</code>,默认为<code>服务站|0</code></p>
<p><br></p>
<h3 id="Stock-service"><a href="#Stock-service" class="headerlink" title="Stock-service"></a>Stock-service</h3><blockquote>
<p>签收入库</p>
</blockquote>
<p>商品到货签收:<code>stockIn</code>,<code>sxc_delivery_stock</code>填写对应的<code>warehouse_id</code></p>
<blockquote>
<p>库存查询</p>
</blockquote>
<p>正常查询库存:<code>getStocks</code></p>
<blockquote>
<p>出库操作 </p>
</blockquote>
<p>正常出库操作:<code>stockOut</code></p>
<p><br></p>
<h3 id="Logistics-service"><a href="#Logistics-service" class="headerlink" title="Logistics-service"></a>Logistics-service</h3><blockquote>
<p>创建需求单</p>
</blockquote>
<p><code>LogisticsRequirementConsumerProcess</code></p>
<p>需求单通过mq进行以下四个操作</p>
<ul>
<li><code>logistcReqireCreate</code></li>
<li><code>logistcReqireClose</code></li>
<li><code>logistcReqDetailUpdate</code></li>
<li><code>logistcReqDetailFinish</code></li>
</ul>
<ul>
<li>1:sourceType 新增对应的 stall档口模式</li>
<li>2:sourceId  填写对应的 stall档口模式</li>
</ul>
<p>创建需求单主单<br>创建需求单子单<br>流程正常走下来</p>
<p>满足调度后期的应配量查询<br><br></p>
<blockquote>
<p>物流调度</p>
</blockquote>
<p>根据需求单和物流交付单-&gt;查询各大服务站or档口所需配送量,传送实际配送量-&gt;从而创建<code>schedule</code>调度单</p>
<blockquote>
<p>合并或取消合并精准调度单    </p>
</blockquote>
<p><code>merge.schedul</code>和<code>cancelMerge.dispatch</code>按原有逻辑</p>
<blockquote>
<p>物流调度费用</p>
</blockquote>
<p>草稿调度单<code>schdulingroute.deliveryFee.edit</code>和精准调度单<br><code>dispatch.deliveryFee.edit</code>两者费用逻辑不更改</p>
<blockquote>
<p>分拣、配送、备货单</p>
</blockquote>
<p>是否影响部分联合查询,导致影响新的档口模式查询</p>
<p>创建排线计划是何意?</p>
<p><br><br><br></p>

        
    </section>
</article>



<div class="comments">
    <div id="disqus_thread">
        <p class="comment-tips">国内查看评论需要代理~</p>
    </div>
    <script>
    window.disqus_config = function () {
        this.language = 'zh';
        this.page.url = 'http://www.coderss.cn/stall-design/index.html';
        this.page.title = '新增配送点[档口+服务站平级模式]';
        this.page.identifier = 'stall-design/index.html';
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://name.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>
</footer>

<script type="text/javascript" src="//s13.cnzz.com/z_stat.php?id=1234567890&amp;web_id=1234567890"></script>


    </div>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    
    <script type="text/javascript">
        $(function() {
            var nodes = {
                nav: $('#nav'),
                aside: $('#aside'),
                navTags: $('#nav-tags')
            };

            $('#open-panel, #aside-mask').on('click', function() {
                nodes.aside.toggleClass('panel-show');
            });
            $('#nav-tag').on('click', function(event) {
                event.preventDefault();console.log(nodes.navTags.attr('class'))
                nodes.navTags.toggleClass('tag-show');console.log(nodes.navTags.attr('class'))
            })/*.hover(function() {
                nodes.navTags.addClass('tag-show');
            }, function() {
                nodes.navTags.removeClass('tag-show');
            });*/

            
        });
    </script>

</body>
</html>
