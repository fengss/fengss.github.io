<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>Edr&amp;Rasp行为类检测方向笔记 | Coderss</title>
    <meta name="author" content="coder">
    <meta name="version" content="1.0.0">
    <meta name="keywords" content="">
    <meta name="description" content="ATT&amp;amp;CK Edr&amp;amp;Rasp学习相关详解笔记  
传统杀软工作原理一切的开始杀毒软件的工作原理: 

传统杀软缺陷以上方法对于家庭电脑是没有问题的,因为出现了未知病毒感染了几个家庭电脑后,这个病毒就已经被杀软捕获分析并且拉黑了但是对于没有见过的病毒来说,杀毒软件需要一段时间进行人工分析.而人工分析需要的时间又非常的多.
但对于安全需要极高的电脑来说,比如政府、军用的电脑,是不允许感染任何病毒的,因此这种杀毒软件的模式无法满足需要.另外对于”APT”组织的攻击,如美国国家安全局N">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="baidu-site-verification" content="F0CXvmUgA9">

    
    
    <link rel="icon" href="/favicon.png">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <div class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <button id="open-panel" class="open-panel"><i class="icon-library"></i></button>

    <nav class="nav-inner">

        
        
        <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/back-end">Java后端</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/cpp">C嵌入式</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/go">Go云原生</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/cloud">Linux安全</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/reverse">Win安全</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/data">大数据处理</a>
        </li>
        
        
        
        <li class="nav-item nav-item-tag">
            <a id="nav-tag" class="nav-link" href="#">标签</a>
            <div id="nav-tags" class="nav-tag-wrap">
                <i class="nav-tag-arrow"></i>
                
  <div class="widget-wrap">
    <h3 class="widget-title">
        <i class="icon-tag vm"></i>
        <span class="vm">Tags</span>
    </h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Boost库/">Boost库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Collection/">Collection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cpp编程/">Cpp编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fescar/">Fescar</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gc/">Gc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/K8s/">K8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MapReduce/">MapReduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Net/">Net</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nosql/">Nosql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python计算库/">Python计算库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rust/">Rust</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sharding-jdbc/">Sharding-jdbc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SkyWalking/">SkyWalking</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark/">Spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TensorFlow/">TensorFlow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Turi/">Turi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows系统/">Windows系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows驱动/">Windows驱动</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yarn/">Yarn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/assembly/">assembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c-cpp语言/">c/cpp语言</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debug/">debug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eth/">eth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go-kernel/">go-kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/io/">io</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/juc/">juc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kubernetes/">kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/map/">map</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mfc/">mfc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservice/">microservice</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netty/">netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python-book/">python-book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qt/">qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sentinel/">sentinel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/skycoin/">skycoin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-cloud/">spring-cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stl/">stl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/x86-Windows系统总结/">x86 Windows系统总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/中台/">中台</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式文件系统/">分布式文件系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程编程/">多线程编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/嵌入式/">嵌入式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/消息队列/">消息队列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络编程/">网络编程</a></li></ul>
    </div>
  </div>


            </div>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/archives">归档</a>
        </li>
        
        
        

    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://www.coderss.cn"></form>

        
        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#传统杀软"><span class="toc-number">1.</span> <span class="toc-text">传统杀软</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#工作原理"><span class="toc-number">1.1.</span> <span class="toc-text">工作原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#传统杀软缺陷"><span class="toc-number">1.2.</span> <span class="toc-text">传统杀软缺陷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EDR的出现"><span class="toc-number">1.3.</span> <span class="toc-text">EDR的出现</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#行为检测"><span class="toc-number">2.</span> <span class="toc-text">行为检测</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#行为检测概念"><span class="toc-number">2.1.</span> <span class="toc-text">行为检测概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#行为检测遇到的问题"><span class="toc-number">2.2.</span> <span class="toc-text">行为检测遇到的问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ATT-amp-CK"><span class="toc-number">3.</span> <span class="toc-text">ATT&amp;CK</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#攻击数据采集"><span class="toc-number">3.1.</span> <span class="toc-text">攻击数据采集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#攻击技术识别"><span class="toc-number">3.2.</span> <span class="toc-text">攻击技术识别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#攻击技术路径-威胁识别"><span class="toc-number">3.3.</span> <span class="toc-text">攻击技术路径-威胁识别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#APT-Hydra"><span class="toc-number">3.3.1.</span> <span class="toc-text">APT-Hydra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#APT-System-discovery"><span class="toc-number">3.3.2.</span> <span class="toc-text">APT-System discovery</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Rasp方向的应用"><span class="toc-number">4.</span> <span class="toc-text">Rasp方向的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Rasp功能现状"><span class="toc-number">4.1.</span> <span class="toc-text">Rasp功能现状</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rasp代码结构现状"><span class="toc-number">4.2.</span> <span class="toc-text">Rasp代码结构现状</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rasp项目期望"><span class="toc-number">4.3.</span> <span class="toc-text">Rasp项目期望</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Rasp方向的行为检测"><span class="toc-number">5.</span> <span class="toc-text">Rasp方向的行为检测</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#客户情况"><span class="toc-number">5.1.</span> <span class="toc-text">客户情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rasp与行为结合点"><span class="toc-number">5.2.</span> <span class="toc-text">Rasp与行为结合点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#组件间功能协作"><span class="toc-number">5.2.1.</span> <span class="toc-text">组件间功能协作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#静态Action"><span class="toc-number">5.2.1.1.</span> <span class="toc-text">静态Action</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#动态Action"><span class="toc-number">5.2.1.2.</span> <span class="toc-text">动态Action</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#行为路径生命周期"><span class="toc-number">5.2.2.</span> <span class="toc-text">行为路径生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#行为粒度"><span class="toc-number">5.2.2.1.</span> <span class="toc-text">行为粒度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#路径生命周期"><span class="toc-number">5.2.2.2.</span> <span class="toc-text">路径生命周期</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#行为犯罪阈值"><span class="toc-number">5.2.3.</span> <span class="toc-text">行为犯罪阈值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#归因逻辑"><span class="toc-number">5.2.4.</span> <span class="toc-text">归因逻辑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#技术识别库的扩充"><span class="toc-number">5.3.</span> <span class="toc-text">技术识别库的扩充</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#业务安全方向"><span class="toc-number">5.3.1.</span> <span class="toc-text">业务安全方向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据安全方向"><span class="toc-number">5.3.2.</span> <span class="toc-text">数据安全方向</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#威胁识别库的扩充"><span class="toc-number">5.4.</span> <span class="toc-text">威胁识别库的扩充</span></a></li></ol></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope="" itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            Edr&amp;Rasp行为类检测方向笔记
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="/2022/08/23/edr-study/">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2022-08-23T09:44:31.000Z" itemprop="datePublished">2022-08-23</time>
</a>

            

        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>ATT&amp;CK Edr&amp;Rasp学习相关详解笔记<br><a id="more"></a>  </p>
<h1 id="传统杀软"><a href="#传统杀软" class="headerlink" title="传统杀软"></a>传统杀软</h1><h2 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h2><p>一切的开始杀毒软件的工作原理: </p>
<p><img src="/2022/08/23/edr-study/image-01.png" width="500px"></p>
<h2 id="传统杀软缺陷"><a href="#传统杀软缺陷" class="headerlink" title="传统杀软缺陷"></a>传统杀软缺陷</h2><p>以上方法对于家庭电脑是没有问题的,因为出现了未知病毒感染了几个家庭电脑后,这个病毒就已经被杀软捕获分析并且拉黑了<br>但是对于没有见过的病毒来说,杀毒软件需要一段时间进行人工分析.而人工分析需要的时间又非常的多.</p>
<p>但对于安全需要极高的电脑来说,比如政府、军用的电脑,是不允许感染任何病毒的,因此这种杀毒软件的模式无法满足需要.<br>另外对于”APT”组织的攻击,如美国国家安全局NSA等黑客组织的专业攻击,他们的病毒绝对是之前没有见过的病毒.</p>
<p>杀毒软件也绝对不可能捕获到这些攻击.专业的黑客组织会将木马伪造成正常文件诱导用户点击打开,而对于杀毒软件,他们在投毒之前就已经确信能100%防止被找到</p>
<h2 id="EDR的出现"><a href="#EDR的出现" class="headerlink" title="EDR的出现"></a>EDR的出现</h2><p>EDR背景的提出</p>
<p>对于非常需要安全措施的电脑,EDR 即终端检测响应(endpoint detection response)概念被提出来了;<br>最简单的理解,客户的一台重要电脑是终端,服务端负责检出,还有专业的安全团队做出响应,防止客户遭到攻击,而EDR则是这一系列流程的概括.</p>
<h1 id="行为检测"><a href="#行为检测" class="headerlink" title="行为检测"></a>行为检测</h1><h2 id="行为检测概念"><a href="#行为检测概念" class="headerlink" title="行为检测概念"></a>行为检测概念</h2><p>对于新型威胁,如点对点攻击,国家级的黑客组织的入侵.国外在12年左右发布了行为检出概念.<br>即不再通过文件进行判断, 而是通过软件的行为,进行威胁检测.<br>举个例子,QQ.exe在某一天突然把你的电脑文件加密了,传统杀毒软件是无法检测到的,因为他们认为QQ是可信的白名单文件而基于行为检测的EDR,则可以很容易的发现,QQ.exe是坏东西.这就是EDR的基础.即上报行为日志,分析行为日志,找出威胁</p>
<h2 id="行为检测遇到的问题"><a href="#行为检测遇到的问题" class="headerlink" title="行为检测遇到的问题"></a>行为检测遇到的问题</h2><p>由于要做行为检测,则需要”软件每做一个动作,我们的EDR就要记录一个动作”.<br>这会导致非常多的日志,在未处理的情况下,我们需要面对9,00000/分钟的数据量一台电脑.<br>因此,如何在海量的行为中检索出数据、对数据进行过滤是行为检测所遇到的问题</p>
<p><br><br><br></p>
<h1 id="ATT-amp-CK"><a href="#ATT-amp-CK" class="headerlink" title="ATT&amp;CK"></a>ATT&amp;CK</h1><p>为了解决海量数据的问题.国外提出了att&amp;ck的架构(不准确,最开始是为了标记出全部可能的攻击手法,但是可以这样理解)<br>att&amp;ck是个矩阵,大概类似于这样:</p>
<blockquote>
<p>这个矩阵容纳了所有可能的攻击方法.分别为</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TA -&gt;即战术, T-&gt;即技术</span><br></pre></td></tr></table></figure>
<blockquote>
<p>比如开机自启动,我们可以这样形容这个行为:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Persistence(持久化)-→Boot or Logon Autostart Execution(在启动阶段自动启动)</span><br><span class="line">如果翻译成机器能识别的东西:TA0003 -&gt;T1547</span><br></pre></td></tr></table></figure>
<p>一个恶意软件,他的特征码在传统软件里面如下:E48E13207341B6BFFB7FB1622282247B<br>一个恶意软件,他的特征码在EDR的软件里面如下: T1083 T1490 T1135 T1486 T1016 T1057</p>
<p>代表:它会会扫描进程，结束指定进程.并且会关掉系统恢复功能，然后识别网络，扫描网络的同时扫描本地文件，最后加密文件<br>那么他就是一个勒索软件病毒的特征码</p>
<h2 id="攻击数据采集"><a href="#攻击数据采集" class="headerlink" title="攻击数据采集"></a>攻击数据采集</h2><p>当前大多数安全软件开始不采用KernelHook方案,而在UserSpace使用Audit日志审计<br>采集攻击日志使用Auditd对Linux日志进行收集, 基于ATT&amp;CK摸下对Webshell的攻击上下文进行威胁建模<br>通过控制流(标签的传递规则) 和 数据流(进程和文件的标签定义) 提高日志的语义化程度, 形成一条完整的攻击链, 并标注生命周期</p>
<p>目前我司提供<code>AssetDiag</code>对进程/文件/血缘关系进行定义、<code>Rasp插件</code>对应用Hook点进行Action动作类型的数据采集<br>悬镜软件供应链AllInOne组件模块中有采用Web日志搜集和语义化分析攻击事件,目前我司<code>AssetDiag</code>也可拥有应用日志作为Source源的技术能力,但是没有技术精力投入且公司重点方向不在此</p>
<h2 id="攻击技术识别"><a href="#攻击技术识别" class="headerlink" title="攻击技术识别"></a>攻击技术识别</h2><ul>
<li>技术识别大类: <a href="https://github.com/redcanaryco/atomic-red-team" target="_blank" rel="noopener">https://github.com/redcanaryco/atomic-red-team</a></li>
</ul>
<blockquote>
<p>举例进程注入的技术T发现</p>
</blockquote>
<p>如果发现当前syscall有createRemoteThread行为则定义进程操作, 当前rule的condition可继续完善<br>这一切要做强RuleEngine的Source数据源, AssetDiag组件 + Hook插桩电</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    'rules': [</span><br><span class="line">        'action == "createremotethread"',</span><br><span class="line">    ],</span><br><span class="line">    'attck_hit':['T1055'],</span><br><span class="line">    'score': 30,</span><br><span class="line">    'name': 'Process Injection'</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="攻击技术路径-威胁识别"><a href="#攻击技术路径-威胁识别" class="headerlink" title="攻击技术路径-威胁识别"></a>攻击技术路径-威胁识别</h2><blockquote>
<p>对比特征码的方案</p>
</blockquote>
<p>文件特征码通常是一个文件对应一个特征码.会有无穷无尽的文件,有无穷无尽的特征码<br>而EDR的att&amp;ck他是有限的集合.一个特征库,文件特征积累了20年,那么可能因为系统更新之类的原因,也就10年内的能用,并且每次遇到一个新的文件,就需要新加一个特征库.简而言之,需要不断更新、不断淘汰.否则就会落后.<br>并且还是不能识别出新型病毒,依然需要人工分析病毒然后入库一个行为特征库,积累20年,基本上能覆盖到各个家族的木马病毒.以及各个可能的攻击手法.甚至是可以通过行为推断出这个软件是什么软件.</p>
<h3 id="APT-Hydra"><a href="#APT-Hydra" class="headerlink" title="APT-Hydra"></a>APT-Hydra</h3><p>Hydra是一个知名的密码破解工具，用于尝试暴力破解各种网络协议的登录凭据，如SSH、FTP、Telnet、HTTP等。它基于多线程和字典攻击技术，可以在较短的时间内尝试大量的密码组合，从而获取访问目标系统的权限。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">['T1027<span class="number">.004</span>', 'T1018', 'T1559<span class="number">.001</span>', 'T1218<span class="number">.011</span>', 'T1059<span class="number">.001</span>', 'T1059<span class="number">.005</span>', 'T1570', 'T1087<span class="number">.002</span>', 'T1564', 'T1106', 'T1082', 'T1087<span class="number">.001</span>', 'T1003', 'T1071']</span><br></pre></td></tr></table></figure>
<h3 id="APT-System-discovery"><a href="#APT-System-discovery" class="headerlink" title="APT-System discovery"></a>APT-System discovery</h3><p>APT-System Discovery 是APT攻击中的一个重要阶段，攻击者通过在目标系统内进行广泛的信息搜集，为后续的攻击行动做准备。企业和组织需要采取一系列的安全措施，包括网络监控、入侵检测系统、强密码策略等，以减轻这种类型的攻击带来的威胁。</p>
<ul>
<li>主机识别：攻击者可能会尝试确定目标网络中的活动主机，发现IP地址范围、子网和主机名等信息。</li>
<li>端口扫描：攻击者可能会扫描目标主机的开放端口，以了解哪些服务和应用程序正在运行，从而识别可能的攻击目标。</li>
<li>服务识别：攻击者可能会尝试确定每个开放端口背后的具体服务和版本信息，以寻找已知的漏洞和攻击向量。</li>
<li>操作系统识别：攻击者可能会分析目标系统的响应，以获取有关操作系统类型和版本的信息。</li>
<li>身份验证探测：攻击者可能会尝试使用各种常见的默认凭据、弱密码或字典攻击等方式，来测试对目标系统的登录是否成功。</li>
<li>内部网络探测：一旦攻击者成功进入系统，他们可能会通过探测内部网络结构和其他主机，以寻找潜在的目标或感兴趣的数据。</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">['T1018','T1087<span class="number">.001</span>', 'T1087<span class="number">.001</span>', 'T1082', 'T1016']</span><br></pre></td></tr></table></figure>
<p><br><br><br></p>
<h1 id="Rasp方向的应用"><a href="#Rasp方向的应用" class="headerlink" title="Rasp方向的应用"></a>Rasp方向的应用</h1><h2 id="Rasp功能现状"><a href="#Rasp功能现状" class="headerlink" title="Rasp功能现状"></a>Rasp功能现状</h2><p>目前引擎组内部研发的Rasp支持以下几类大的功能模块</p>
<ul>
<li>热注入【已完成】<ul>
<li>支持Python、Php运行时热注入安全免疫代码</li>
<li>支持Golang运行时热注入安全免疫代码【待开发】</li>
</ul>
</li>
<li>Web资产清点【部分完成】<ul>
<li>ApiCollect; Api搜集Python/Php内部的Api信息</li>
<li>ThirdCollect; Python/Php的三方组件搜集</li>
</ul>
</li>
<li>静态内存扫描【待开发】<ul>
<li>主动扫描内存中已注册的内存马,驻留的内存马</li>
</ul>
</li>
<li>Web应用漏洞实时检测/防护【部分完成,待安全研究部门整合】<ul>
<li>基于V8 Js库翻译本地机器码语言,检测请求上下文/Hook点Args威胁</li>
</ul>
</li>
<li>行为检测【待开发】<ul>
<li>基于ATT&amp;CK模型, 进行行为狩猎</li>
</ul>
</li>
<li>WebApiProtect(Api防护)【部分完成,待安全研究部门整合】<ul>
<li>基于Api的Flow流量,对接RuleEngine进行流量防护</li>
</ul>
</li>
<li>热修复【待定】<ul>
<li>参考组件防御的能力</li>
</ul>
</li>
</ul>
<h2 id="Rasp代码结构现状"><a href="#Rasp代码结构现状" class="headerlink" title="Rasp代码结构现状"></a>Rasp代码结构现状</h2><table>
<thead>
<tr>
<th>Rasp</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="/2022/08/23/edr-study/image-02.png" width="800px"></td>
<td>- engine.core.rasp: 处理Rasp行为狩猎和【Probe&amp;后端】指令接收处理 <br>- engine.inject: 处理运行时热注入 <br>- engine.network: websocket/grpc后端通讯<br> - engine.probe: probe通讯连接 <br> - probe.client.core: 处理Web应用漏洞实时检测/防护、Api流量防护<br> - probe.php/python: 各语言特性插桩和Hook</td>
</tr>
</tbody>
</table>
<h2 id="Rasp项目期望"><a href="#Rasp项目期望" class="headerlink" title="Rasp项目期望"></a>Rasp项目期望</h2><ul>
<li>V8规则翻译: 我们探讨已决定去除Js规则引擎,那翻译的规则JavaAgent写一份,小众语言归拢到Rasp Probe模块中? 还是JavaAgent也归拢Rasp Probe?</li>
<li>行为检测: 行为检测请看以下方案输出, 探讨是否ok</li>
<li>WebApiProtect(Api防护): 这类类似WAAP、WAF的功能模块,但是因为插桩进用户进程可玩性比WAF高,是否加装此模块</li>
</ul>
<p><br><br><br></p>
<h1 id="Rasp方向的行为检测"><a href="#Rasp方向的行为检测" class="headerlink" title="Rasp方向的行为检测"></a>Rasp方向的行为检测</h1><h2 id="客户情况"><a href="#客户情况" class="headerlink" title="客户情况"></a>客户情况</h2><ul>
<li>安芯网盾: 强大的行为检测能力,能识别恶意攻击行为20+、行为监测点200+</li>
<li>字节跳动: 因为字节已有CWPP成熟的主机安全产品, 覆盖的而已攻击行为上千+</li>
<li>pbom.dev: 一种全面、系统且可操作的方法，用于了解软件供应链方面的攻击者行为和技术</li>
</ul>
<blockquote>
<p>以下是字节跳动技术识别图谱</p>
</blockquote>
<table>
<thead>
<tr>
<th>侦察</th>
<th>资源准备</th>
<th>初始访问</th>
<th>执行</th>
<th>持久化</th>
<th>权限提升</th>
<th>防御规避</th>
<th>凭证访问</th>
<th>信息发现</th>
<th>横向移动</th>
<th>收集数据</th>
<th>命令与控制</th>
<th>数据渗出</th>
<th>影响</th>
</tr>
</thead>
<tbody>
<tr>
<td>收集受害者主机信息</td>
<td>获取基础设施</td>
<td>外部远程服务</td>
<td>Windows 管理规范</td>
<td>引导或登录初始化脚本</td>
<td>引导或登录初始化脚本</td>
<td>直接卷访问</td>
<td>中间对手</td>
<td>查看系统所有者/用户</td>
<td>污染共享内容</td>
<td>屏幕截图</td>
<td>应用层协议</td>
<td>通过 Web 服务进行数据回传</td>
<td>磁盘擦除</td>
</tr>
<tr>
<td>搜索受害者拥有的网站</td>
<td>入侵基础设施</td>
<td>通过可移动媒体进行复制</td>
<td>共享模块</td>
<td>创建或修改系统进程</td>
<td>创建或修改系统进程</td>
<td>Rootkit</td>
<td>操作系统凭证转储</td>
<td>查看容器和资源</td>
<td>通过可移动媒体进行复制</td>
<td>中间对手</td>
<td>远程访问软件</td>
<td>预定时间转移数据</td>
<td>服务停止</td>
</tr>
<tr>
<td>收集受害者身份信息</td>
<td>入侵账户</td>
<td>供应链入侵</td>
<td>计划任务/作业</td>
<td>外部远程服务</td>
<td>引导或登录自动启动执行</td>
<td>修改云计算基础设施</td>
<td>窃取网络会话 Cookie</td>
<td>查看权限组</td>
<td>使用替代认证材料</td>
<td>收集配置存储库的数据</td>
<td>交通信号</td>
<td>通过其他网络介质数据回传</td>
<td>污损</td>
</tr>
<tr>
<td>搜索开放技术数据库</td>
<td>筹划能力</td>
<td>利用公开应用</td>
<td>原生 API</td>
<td>引导或登录自动启动执行</td>
<td>计划任务/作业</td>
<td>弱加密</td>
<td>网络嗅探</td>
<td>查看组策略</td>
<td>远程服务</td>
<td>音频捕捉</td>
<td>协议隧道</td>
<td>自动数据回传</td>
<td>数据处理</td>
</tr>
<tr>
<td>主动扫描</td>
<td>建立账户</td>
<td>信任关系</td>
<td>部署容器</td>
<td>Office 应用程序启动</td>
<td>进程注入</td>
<td>隐藏工件</td>
<td>窃取或伪造 Kerberos 门票</td>
<td>查看系统服务</td>
<td>远程服务会话劫持</td>
<td>电子邮件收集</td>
<td>通过可移动媒体进行交流</td>
<td>通过 C2 通道数据回传</td>
<td>关闭帐户访问</td>
</tr>
<tr>
<td>收集受害者组织信息</td>
<td>获取组建</td>
<td>网络钓鱼</td>
<td>命令和脚本解释器</td>
<td>计划任务/作业</td>
<td>宿主机逃逸</td>
<td>间接命令执行</td>
<td>来自密码存储的凭据</td>
<td>网络嗅探</td>
<td>软件部署工具</td>
<td>收集可移动媒体的数据</td>
<td>代理</td>
<td>通过替代协议的数据回传</td>
<td>为影响而加密的数据</td>
</tr>
<tr>
<td>收集受害者网络信息</td>
<td>发展能力</td>
<td>有效账户</td>
<td>容器管理命令</td>
<td>浏览器扩展</td>
<td>滥用高程控制机制</td>
<td>去混淆/解码文件或信息</td>
<td>不安全凭证</td>
<td>查看网络共享</td>
<td>远程服务的利用</td>
<td>自动收集</td>
<td>动态分辨率</td>
<td>数据传输大小限制</td>
<td>端点拒绝服务</td>
</tr>
<tr>
<td>搜索打开的网站/域</td>
<td></td>
<td>硬件添加</td>
<td>用户执行</td>
<td>交通信号</td>
<td>劫持执行流</td>
<td>削弱防御</td>
<td>窃取应用程序访问令牌</td>
<td>查看外围设备</td>
<td>内部鱼叉式钓鱼</td>
<td>收集剪贴板数据</td>
<td>网络服务</td>
<td>将数据传输到云帐户</td>
<td>资源劫持</td>
</tr>
<tr>
<td>搜索封闭源</td>
<td></td>
<td>路过式攻击</td>
<td>软件部署工具</td>
<td>植入内部图像</td>
<td>有效账户</td>
<td>伪装</td>
<td>伪造网络凭证</td>
<td>查看系统信息</td>
<td>横向工具移动</td>
<td>收集云存储的数据</td>
<td>多级通道</td>
<td>物理介质数据回传</td>
<td>数据销毁</td>
</tr>
<tr>
<td>信息网络钓鱼</td>
<td></td>
<td></td>
<td>进程间通信</td>
<td>操作系统前引导</td>
<td>提权利用</td>
<td>进程注入</td>
<td>多因素身份验证请求生成</td>
<td>查看应用程序</td>
<td></td>
<td>收集本地系统的数据</td>
<td>数据混淆</td>
<td></td>
<td>网络拒绝服务</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>利用客户端执行</td>
<td>侵入客户端二进制</td>
<td>事件触发执行</td>
<td>交通信号</td>
<td>凭据访问的利用</td>
<td>查看云基础设施</td>
<td></td>
<td>归档收集的数据</td>
<td>非标准端口</td>
<td></td>
<td>固件损坏</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>系统服务</td>
<td>账户操纵</td>
<td>访问令牌操作</td>
<td>系统二进制代理执行</td>
<td>暴力破解</td>
<td>查看浏览器书签</td>
<td></td>
<td>浏览器会话劫持</td>
<td>加密频道</td>
<td></td>
<td>禁止系统恢复</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>劫持执行流</td>
<td>域策略修改</td>
<td>反射代码加载</td>
<td>强制认证</td>
<td>查看系统网络配置</td>
<td></td>
<td>视频截取</td>
<td>非应用层协议</td>
<td></td>
<td>系统关机/重启</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>有效账户</td>
<td></td>
<td>使用替代认证材料</td>
<td>输入捕捉</td>
<td>查看账户</td>
<td></td>
<td>数据暂存</td>
<td>数据编码</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>事件触发执行</td>
<td></td>
<td>流氓域控制器</td>
<td>多重身份验证拦截</td>
<td>查看信任域</td>
<td></td>
<td>收集网络共享驱动器的数据</td>
<td>入口工具转移</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>位工作</td>
<td></td>
<td>部署容器</td>
<td>修改认证过程</td>
<td>查看文件和目录</td>
<td></td>
<td>输入捕捉</td>
<td>后备频道</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>服务器软件组件</td>
<td></td>
<td>修改注册表</td>
<td></td>
<td>查看系统网络连接</td>
<td></td>
<td>收集信息存储库的数据</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>创建账户</td>
<td></td>
<td>未使用/不支持的云区域</td>
<td></td>
<td>虚拟化/沙盒规避</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>修改认证过程</td>
<td></td>
<td>文件和目录权限修改</td>
<td></td>
<td>查看云存储对象</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>滥用高程控制机制</td>
<td></td>
<td>查看进程</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>主机上的标记移除</td>
<td></td>
<td>查看密码策略</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>plist文件修改</td>
<td></td>
<td>查询注册表</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>操作系统前引导</td>
<td></td>
<td>查看系统位置</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>在主机上构建映像</td>
<td></td>
<td>查看云服务</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>虚拟化/沙盒规避</td>
<td></td>
<td>查看远程系统</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>执行护栏</td>
<td></td>
<td>查看网络服务</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>修改系统映像</td>
<td></td>
<td>查看软件</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>劫持执行流</td>
<td></td>
<td>云服务仪表板</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>有效账户</td>
<td></td>
<td>调试器规避</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>混淆文件或信息</td>
<td></td>
<td>查看系统时间</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>网络边界桥接</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>颠覆信任控制</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>位工作</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>模板注入</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>访问令牌操作</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>调试器规避</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>域策略修改</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>XSL 脚本处理</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>修改认证过程</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>系统脚本代理执行</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>防御规避利用</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>受信任的开发者实用程序代理执行</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>以下是pbom.dev技术识别图谱</p>
</blockquote>
<p><img src="/2022/08/23/edr-study/image-03.png" width="100%"></p>
<p><br><br><br></p>
<h2 id="Rasp与行为结合点"><a href="#Rasp与行为结合点" class="headerlink" title="Rasp与行为结合点"></a>Rasp与行为结合点</h2><h3 id="组件间功能协作"><a href="#组件间功能协作" class="headerlink" title="组件间功能协作"></a>组件间功能协作</h3><h4 id="静态Action"><a href="#静态Action" class="headerlink" title="静态Action"></a>静态Action</h4><img src="http://www.plantuml.com/plantuml/svg/fL7BQi905DtFLymF-0D22YbsuQ9auHU4T2g1C94ak5PhIusjfhH5iIjfhK8MeGiVrAWVqymZVz7O4S74XT3blUUUS-xXQ2PsBDE0icqZfw2hPRPiHiiPq7RxagPYZApKLZQC8bOm8XzZudMO7-oH2rpMCTgT0qc21LHLAZRh1DnjG4a21uAviuCn3ukgHbi-xNP_QlNIkN8fXZGfOv-7r1sH9vUidadhCHvujF4ECbT7YN5lmZxhSaNFaTjHj9xouKEq-1OIx6j9xdtmbuDll0IYlTcfKVQ4_-O085LEGZnSv2496sInO8CctxonIPiFQopiy-1k-pus7GJDAhAWUPtfER6cmKkqRiStAzeFX8uGaJL7Dt5IX1W5H5lZ99M0IFZAftE0y1NSUXnvyyHylm00">
<h4 id="动态Action"><a href="#动态Action" class="headerlink" title="动态Action"></a>动态Action</h4><img src="http://www.plantuml.com/plantuml/svg/bLZfLnfP5lyS_WeE7_gJ89i8dabcd2mTfpDfZp7JPwRJXnJmW58iw2fqp9cJSt29ek8MDN4XYudR92renoXXaV-bmtjLVCg_CFVLAx70g9alMdNVkzllBdKld3yU5OtLmZpEl35mwWlEJE0dEqfvJfdRDFYZGboCHeoTOjI7oEnJilvVlB9J8zyKGho0vC9efN1O8xPB4ehVuBbG8pqIwH1-513UsCPpC_BxhC5mzQfHAQ_9ErDATWmdtnklNZKqS9klDH3QZBYqW2UcAxa2IUULZwEL_BQyjYmFV_e6Lb2chASO4rFvBKpRepYvWejBP646PpzfAWjZykzFSNvBoSBfnWEXgp-261pcQ_JvdrnVn7pjUbG8y74-AfohhH6KDcCbDqacDtKGoIExvCCEVhAfujF8OBwcZrYR5hzAFe_db_7-ahoHntEZydv1oUugEma6DtwQ-WdvcidI7fdEuFo25Ycze7DCovDNSvMS9gQfafl2i_Cr-qXgl5BO-9g9-aGv4NCxAiLP546Cl3eAf4u-m2GpIKoyGS_SA8hCR9B5mqOBBkA0Q95dk_9QXhmUx-R448epP2gb1Vb3uO7G6Ov1k5cctElu_lwzBZiG7yN3KG7ebNmAZd2IgbHA9JAn3TSw7ocZgoJzMysC1yBtqGWdX1fkXwFHtWRRwWjBXOQPfjL5gGJYMCO3H0rbMFzwLfZ6dKcHv5mJBYRmzXIPpv6Pf-qndZbucrfqcHXw2HzjLaff9ih02dSz1SQolFwEvIpDJo4QHyRe01ADqM1Zsr3AAzNnL3MTKBQ6bEstUEn3TVKOAhVwF5DzisomVKuCgRh6Iv2Pu2wU7QOfkfp5SrjuurbrP0VFPidCTfDSpEEz-GvEYfFzTLhwzZfMg5MQbgkZ452vy8fPgecPNCVb9nJVx9ZcGRcavDxH_9jCa7Isk-dauckAtSwGCZ8axqx8q33sHiZImPyDI0WOLIyD5pfRAMp-aKYJfLao-eeyWxGyLB85FBQ2dtnGXXOh-IcW_95u0HPKZgVmxfpXMsvNLm_n_ijAVkPXUtVtTzT_C9B50XuluBLZPM__eRdRPdKxp9NoEXdAKWHczfh9gqqvFSL4Gjb3Sk7IKiq70slzNqcTxIqGG245U1_sS0ESXOzQRl4Hr274-kFtuYBY-XwIrpbS7c6WNvf6Sc4PAW7FJogxMwppN8ZVVmnNJ3UGv3Ur6KtC5rmSnhaSZPGE8B8m3ObfQeBRjpcnxmuQG17A4kP3OPNQVkTcLxVtHdjtEv11w1LJr_qxDxqTTs_zg17WZf_sQ7WL-YEH9aOA1f4_ZWAiHL298YV5JDfXFxG3aH87_M6Dzd_Pokxp8O6BexlH0AfJVKj4lrwFzWlnMpoA1AXCKyD1zwCOQg3VvkDTI58j3N8H2PsUT44ZehUjZFHLb83-0n-9N0zplD1nGoUQVieOGOGdByN0IxF16uHKy4f8aE3pDe3Ogy3r8Sah_bl7UnT8bFjiPkikdRXp0yKHYmGxwmwBI0f7DGo0zDXmvJ6DAHUFS_vUBnypjPbi7hl5vd9RR5QhnMPlRNErMcrmrnJdLSqsbyVXzdWSBWzbv5LHBcVG5U1SBf_Rwcdr-_mkcy_cT74sDL-u41BYNdOn40nwWi5Wgzbluv2v9U1eDRk3FfUvnHzm1QnkLz3X2J0cCIHHXfyVc0O71n-OVgbHlPmeSe_Wx6UQUgVdXYk_Q5S6A6DploGs-tYXcO9hX3k39hsZ0M-4bzGiL4jSFVD5elvUfDgfHbmb-YES96dMCt_w4EHge8w41b5DPuJtDVSCzAbwpJQBss8rHsD8w0dqiZUBeyLkyLdTPhi5HLgz7ikWs-LrEPjxH5IpLnKQ334LLlRMhtyBmwTUq3AXrorPxIgL5xnqDeIKGsAz5t32nmQSDQTFOWn_MnnDjbRuJqspDTci5hlJQR5PhAUFDfq8Lqs4XeKaGNozMcwOM7AuhQxM-cCj7-rd0MJ-25AClRQud4pTcVSQmU5c1DhTl7G2eEHp6ghbJxp0nw_f6A0tIgmrCO8yaOH1u-H2eD-lEWS3ALuOmdFJylQUUYQobdMEch-uh4wdamioKyMwm8cyH2rqgCzrGLGRW71XFSCTuGJRl_tZxtgItXD8BFL8gjCiQIdgQF6mTpNruoBdL-KD3jQgGdVY3NDIc1uxNBuWSWPHYzlgzpZy0P-zrU46MJwxmucWbPzXZ23L5eVpp4bKvEkhLbMi5QpK7meXIVjSc3udvl36g5pAu49UoMG-9-RbzOoIsM2GrDe_6oagkLKOFyZkM_WoiDdZIt4DftVeOF5g4ozCu_nYTVcGP3x2c5DDh2hbSMDN-xrE8roG5tV8woJxiZCLRFIaCyhisy-9OUP5NS3Y76jAx4N3sio2Vau5g96AzOPEZw1pEcj7W59VJAqCgzrXjdhCrfPkQskRmzLcTVoBtL8HPAhOixz73FJ6Mdh2lzfHH6WPuAKUpJojogYBtf_Qk-u2zV7fP7BPEC466taoAvVULPUJE54q6hX8tCYUSN9FEJwcaqRogPml6wvSEkH2cYBnhxIdLfSBi26mePjziWq8EfFnSY5ayPZ6f8vJ29nnfN4RKlSz_LoaRdrwps2mld0BMZm4XrKrJ7cTj8iuMPen9YLxHFQ7bVpxIg64rrx3JDg4txmaHmMMhFNJMjtgh-V1MyEmjnckGwVZaVIbk6g458SPaoIFO1M4wKZvU0I5mPHLShjVYYcIdgPp-GeTxs5iPZOfcMEeAzWrAxbtU34B3xISrC5T_cthIp59n-QjOM1dghuK9yYBJRQFaEmiSD6QIHv1RHZkGME7YgN6DEZ2oJKeNQQbKbnLiY-eaADNi1BeXL23CsNOKwYqZawStiCl4byHTsBw7WpPZ87v2VmdN22VhQ1QK_WqHPC5b9R7gN1s7syS03Hq1L8zrxaDS9vYgNe03KJ7KrqPXTNbVDXI9Bi8i06wU6Fyh09g0dDPEO3QEL8LRWsJbsbeJd10Vpp8pyB-HfrYqAmKm5cIV4PNtx4KQAWElwryIke1qKkiuSk8vw2WOeTdnl3ix-Jv9Yu__mhO36OMfWQmMQC4Mt3g2PdwZJm_h3u_8CaFi2RUxxe3-nmeqL8_EKPUpjLhIfr9aZFnIazGj_OBbMAnbipKy5hxegs8rSr9Gzh0cTNBVfc0ArejgXL5HQiov8EiabdNLbDGNiaTo4if4Alsbyj-Kg2_ekZw6_kHf8ci7P1dUymw9JM2rmuCXly1">
<h3 id="行为路径生命周期"><a href="#行为路径生命周期" class="headerlink" title="行为路径生命周期"></a>行为路径生命周期</h3><h4 id="行为粒度"><a href="#行为粒度" class="headerlink" title="行为粒度"></a>行为粒度</h4><p>EDR以进程Action做行为分析、Rasp以请求Action</p>
<h4 id="路径生命周期"><a href="#路径生命周期" class="headerlink" title="路径生命周期"></a>路径生命周期</h4><p><img src="/2022/08/23/edr-study/image-04.jpg" width="900px"></p>
<img src="http://www.plantuml.com/plantuml/svg/XL9DRzf04Btlh_0FQ9HxL7A8b5xQGmz8lQOXJeL2SON88JUxiO8X9OI6fXIY4YBnqKGOa2BisC7vCV7Chlz55o-YfbJkoUlPUM_UlddlKtab9mLk5SmRabAo-PoIaTxcb5qPAr-n_Gj-z1VbxUo7T5Qchkwx4q8I2Ocrl_Ys0vKghRMaH888chNDPVo6n3i2LKDjWdg53IqSVoRBBQiGwjR1c42rn0PT_3R2iha2YShPa71Sm59d2V17ehYSIOo2LYZEEbXRdXdRNlIWu8ZtCEVETwVGl8R1ENjgygdCR5FpkwYBSooPxtQY75ppQ_deHJXZUW75Cl_pxLFQqA6liMDjwp1r8EVZ6VbcGcYKLz14EQWxWEgKHCnYrX0ytRTLrZF-PrbmepFJux9smBPPJtydx-9Z1Uz_xZohshmsJqauCopJMXyDYnLkmMpu3yNvJUmS6BeBAx2aujKmoRedj7a9ncXXId3XhKUV4CyOSd4uypm1zvqUpp5QOt2wU-dzVR1CK1zV1dM3VsAvn7xnSYP5j6zb5ENZgtGcB-U4jQ8Sg0tQ-aSE_qx_2WaF9GSkEcQHRfsBnHx8HuJmpazITArerN4yYj-TLeQpasJo3JS1hrfS-pnLSdPFcX6Itm00">
<h3 id="行为犯罪阈值"><a href="#行为犯罪阈值" class="headerlink" title="行为犯罪阈值"></a>行为犯罪阈值</h3><h3 id="归因逻辑"><a href="#归因逻辑" class="headerlink" title="归因逻辑"></a>归因逻辑</h3><p><br><br><br></p>
<h2 id="技术识别库的扩充"><a href="#技术识别库的扩充" class="headerlink" title="技术识别库的扩充"></a>技术识别库的扩充</h2><h3 id="业务安全方向"><a href="#业务安全方向" class="headerlink" title="业务安全方向"></a>业务安全方向</h3><p><img src="/2022/08/23/edr-study/image-05.png" width="100%"></p>
<h3 id="数据安全方向"><a href="#数据安全方向" class="headerlink" title="数据安全方向"></a>数据安全方向</h3><p><img src="/2022/08/23/edr-study/image-06.png" width="100%"></p>
<p><br><br><br></p>
<h2 id="威胁识别库的扩充"><a href="#威胁识别库的扩充" class="headerlink" title="威胁识别库的扩充"></a>威胁识别库的扩充</h2>
        
    </section>
</article>



<div class="comments">
    <div id="disqus_thread">
        <p class="comment-tips">国内查看评论需要代理~</p>
    </div>
    <script>
    window.disqus_config = function () {
        this.language = 'zh';
        this.page.url = 'http://www.coderss.cn/2022/08/23/edr-study/';
        this.page.title = 'Edr&amp;Rasp行为类检测方向笔记';
        this.page.identifier = '2022/08/23/edr-study/';
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://name.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>
</footer>

<script type="text/javascript" src="//s13.cnzz.com/z_stat.php?id=1234567890&amp;web_id=1234567890"></script>


    </div>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    
    <script type="text/javascript" src="/js/scrollspy.min.js"></script>
    
    <script type="text/javascript">
        $(function() {
            var nodes = {
                nav: $('#nav'),
                aside: $('#aside'),
                navTags: $('#nav-tags')
            };

            $('#open-panel, #aside-mask').on('click', function() {
                nodes.aside.toggleClass('panel-show');
            });
            $('#nav-tag').on('click', function(event) {
                event.preventDefault();console.log(nodes.navTags.attr('class'))
                nodes.navTags.toggleClass('tag-show');console.log(nodes.navTags.attr('class'))
            })/*.hover(function() {
                nodes.navTags.addClass('tag-show');
            }, function() {
                nodes.navTags.removeClass('tag-show');
            });*/

            
            $(document.body).scrollspy({target: '#aside-inner'});
            
        });
    </script>

</body>
</html>
