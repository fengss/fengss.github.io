<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>物流仓储分享 | Coderss</title>
    <meta name="author" content="coder">
    <meta name="version" content="1.0.0">
    <meta name="keywords" content="">
    <meta name="description" content="技术笔记">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="baidu-site-verification" content="F0CXvmUgA9">

    
    
    <link rel="icon" href="/favicon.png">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <div class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <button id="open-panel" class="open-panel"><i class="icon-library"></i></button>

    <nav class="nav-inner">

        
        
        <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/back-end">Java前后端</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/cpp">Cpp嵌入式</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/go">Go云原生</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/cloud">Linux安全</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/reverse">Win安全</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/data">数据与算法</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/work">工作相关</a>
        </li>
        
        
        
        <li class="nav-item nav-item-tag">
            <a id="nav-tag" class="nav-link" href="#">文章标签</a>
            <div id="nav-tags" class="nav-tag-wrap">
                <i class="nav-tag-arrow"></i>
                
  <div class="widget-wrap">
    <h3 class="widget-title">
        <i class="icon-tag vm"></i>
        <span class="vm">Tags</span>
    </h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Boost库/">Boost库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Collection/">Collection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cpp编程/">Cpp编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fescar/">Fescar</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gc/">Gc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/K8s/">K8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MapReduce/">MapReduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Net/">Net</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nosql/">Nosql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python计算库/">Python计算库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rust/">Rust</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sharding-jdbc/">Sharding-jdbc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SkyWalking/">SkyWalking</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark/">Spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TensorFlow/">TensorFlow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Turi/">Turi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows系统/">Windows系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows驱动/">Windows驱动</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yarn/">Yarn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/assembly/">assembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c-cpp语言/">c/cpp语言</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debug/">debug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eth/">eth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go-kernel/">go-kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/io/">io</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/juc/">juc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kubernetes/">kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/map/">map</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mfc/">mfc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservice/">microservice</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netty/">netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python-book/">python-book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qt/">qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sentinel/">sentinel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/skycoin/">skycoin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-cloud/">spring-cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stl/">stl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/x86-Windows系统总结/">x86 Windows系统总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/中台/">中台</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式文件系统/">分布式文件系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程编程/">多线程编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/嵌入式/">嵌入式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/消息队列/">消息队列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络编程/">网络编程</a></li></ul>
    </div>
  </div>


            </div>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/archives">历史归档</a>
        </li>
        
        
        

    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://www.coderss.cn"></form>

        
        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Tms"><span class="toc-number">1.</span> <span class="toc-text">Tms</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、订单池"><span class="toc-number">1.1.</span> <span class="toc-text">1、订单池</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、-配送点"><span class="toc-number">1.2.</span> <span class="toc-text">2、 配送点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、-承运池"><span class="toc-number">1.3.</span> <span class="toc-text">3、 承运池</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#城配承运单"><span class="toc-number">1.3.1.</span> <span class="toc-text">城配承运单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#场内承运单"><span class="toc-number">1.3.2.</span> <span class="toc-text">场内承运单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基地承运单"><span class="toc-number">1.3.3.</span> <span class="toc-text">基地承运单</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、-精准承运单"><span class="toc-number">1.4.</span> <span class="toc-text">4、 精准承运单</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、-物流报销"><span class="toc-number">1.5.</span> <span class="toc-text">5、 物流报销</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、抽检"><span class="toc-number">1.6.</span> <span class="toc-text">6、抽检</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Wms"><span class="toc-number">2.</span> <span class="toc-text">Wms</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#库存点管理"><span class="toc-number">2.1.</span> <span class="toc-text">库存点管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#场景"><span class="toc-number">2.1.1.</span> <span class="toc-text">场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#库存点表"><span class="toc-number">2.1.2.</span> <span class="toc-text">库存点表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#库存点和外部id映射表"><span class="toc-number">2.1.3.</span> <span class="toc-text">库存点和外部id映射表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#库存管理"><span class="toc-number">2.2.</span> <span class="toc-text">库存管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#服务站库存管理"><span class="toc-number">2.2.1.</span> <span class="toc-text">服务站库存管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#档口库存管理"><span class="toc-number">2.2.2.</span> <span class="toc-text">档口库存管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中心仓库存管理"><span class="toc-number">2.2.3.</span> <span class="toc-text">中心仓库存管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#上游wms库存管理（待接入）"><span class="toc-number">2.2.4.</span> <span class="toc-text">上游wms库存管理（待接入）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#档口拆包"><span class="toc-number">2.3.</span> <span class="toc-text">档口拆包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#锁定库存"><span class="toc-number">2.4.</span> <span class="toc-text">锁定库存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#档口下单"><span class="toc-number">2.4.1.</span> <span class="toc-text">档口下单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#库存盘点"><span class="toc-number">2.4.2.</span> <span class="toc-text">库存盘点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#操作记录"><span class="toc-number">2.5.</span> <span class="toc-text">操作记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#批次号"><span class="toc-number">2.6.</span> <span class="toc-text">批次号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#库存盘点-1"><span class="toc-number">2.7.</span> <span class="toc-text">库存盘点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#档口盘点"><span class="toc-number">2.7.1.</span> <span class="toc-text">档口盘点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中心仓盘点"><span class="toc-number">2.7.2.</span> <span class="toc-text">中心仓盘点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#物流调整路线"><span class="toc-number">3.</span> <span class="toc-text">物流调整路线</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#调整初始化-拆单"><span class="toc-number">3.1.</span> <span class="toc-text">调整初始化(拆单)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#调线流程-拆单"><span class="toc-number">3.2.</span> <span class="toc-text">调线流程(拆单)</span></a></li></ol></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope="" itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
           物流仓储分享
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="/tms-wms/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2020-06-18T06:10:55.000Z" itemprop="datePublished">2020-06-18</time>
</a>

            

        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="Tms"><a href="#Tms" class="headerlink" title="Tms"></a>Tms</h1><h2 id="1、订单池"><a href="#1、订单池" class="headerlink" title="1、订单池"></a>1、订单池</h2><blockquote>
<p>档口需求单、服务站需求单、场内采购单、基地采购单</p>
</blockquote>
<p>通过<code>sourceType</code>区分<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_ORDER(0, &quot;订单&quot;),</span><br><span class="line">SITE_PURCHASE(1, &quot;场内采购单&quot;),</span><br><span class="line">BASE_PURCHASE(2, &quot;基地采购单&quot;),</span><br><span class="line">STALL_PURCHASE(3, &quot;档口需求单&quot;),</span><br><span class="line">BASE_DIRECT_PURCHASE(5, &quot;基地直发采购单&quot;);</span><br></pre></td></tr></table></figure></p>
<p>所有的需求单以Requirement-<code>Location</code>送货地为主, RequirementDetail-<code>Sku</code>货物需求单为辅<br>需求单和需求子单都会以<code>sourceId</code>,<code>sourceSubId</code>来溯源外部业务场景的单据ID<br>需求子单会有<code>detail_status</code> <code>需求子单状态：0:取消配送; 10:待配送；80:配送完成</code>表明配送进度<br><code>sign_status</code>  <code>签收状态0未签收 90部分签收 100全部签收</code>来表明签收进度</p>
<h2 id="2、-配送点"><a href="#2、-配送点" class="headerlink" title="2、 配送点"></a>2、 配送点</h2><blockquote>
<p>档口、服务站、中心仓、虚拟中心仓(虚拟不存在的配送点)</p>
</blockquote>
<p>通过<code>siteType</code>区分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CENTER_HOUSE(0,&quot;中心仓&quot;),</span><br><span class="line">PICK_HOUSE(1,&quot;提货仓&quot;),</span><br><span class="line">VIRTUAL_CENTER_HOUSE(3,&quot;虚拟中心仓&quot;),</span><br><span class="line">OUT_VIRTUAL_HOUSE(4,&quot;场外虚拟仓&quot;),</span><br><span class="line">STALL(5,&quot;档口&quot;);</span><br></pre></td></tr></table></figure>
<p>所有配送点以DistributionSite, 配送点id相同, 后期根据外部类型和外部站点ID来确定唯一的配送点</p>
<p>配送点外来途径: .stall(档口), ._storehouse(中心仓、服务站)</p>
<blockquote>
<p>虚拟仓的用法?</p>
</blockquote>
<p>押车多签: 类似大车转小车, 车开到中心仓, 然后小车来的时候, 进行一次签收操作, 入到虚拟库存, 虚拟库存再建城配单, 线下就是大车的货物叫搬运工转小车上, 告诉小车去哪些服务站或档口</p>
<p>大车转小车: 一次性签收完毕, 将所有过来的小车做个配送统计, 再从虚拟中心仓上签实际小车发货的情况, 小车可能大于等于一辆, 然后将货物慢慢的挪到小车进行配送到服务站</p>
<h2 id="3、-承运池"><a href="#3、-承运池" class="headerlink" title="3、 承运池"></a>3、 承运池</h2><blockquote>
<p>承运单: 场内承运单、城配承运单、基地承运单</p>
</blockquote>
<p>通过<code>sourceType</code>区分<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SITE(1,&quot;场内&quot;),</span><br><span class="line">BASE(2,&quot;基地&quot;),</span><br><span class="line">CENTER_HOUSE(3,&quot;中心仓&quot;),</span><br><span class="line">VIRTUAL_CENTER_HOUSE(7, &quot;虚拟中心仓&quot;)</span><br></pre></td></tr></table></figure></p>
<p><img src="/tms-wms/index/image-09.png" width="800px"></p>
<h3 id="城配承运单"><a href="#城配承运单" class="headerlink" title="城配承运单"></a>城配承运单</h3><p>选定某个中心仓为发货点, 再根据<code>订单池</code>中档口的<code>档口需求单</code>、服务站的<code>服务站需求单</code> 创建发往服务站或档口的<code>城配承运单</code></p>
<ul>
<li>选择某中心仓发货点, 再根据订单池的<code>档口需求单</code>,<code>服务站需求单</code>进行发往服务站或档口的创线操作</li>
<li>快捷发货进行二次确认</li>
</ul>
<h3 id="场内承运单"><a href="#场内承运单" class="headerlink" title="场内承运单"></a>场内承运单</h3><p>同城采购创建 <code>场内采购单</code> 发配到固定一个<code>中心仓</code> -&gt; 中途可调整路线变更到有具体 <code>档口需求单</code>的档口或直接入仓到中心仓</p>
<p>调整路线: 一个承运单可以根据剩余的未签收货物,随意调整这些Sku额外的卸货地和卸货数量(卸货地只允许档口和中心仓,不允许服务站)</p>
<blockquote>
<p>操作步骤 </p>
</blockquote>
<ul>
<li>采购方选择供应商和具体的Sku还有中心仓目的地进行下单操作,生成<code>场内采购单</code>到物流订单池</li>
<li>物流根据订单池的场内采购单进行承运操作</li>
<li>承运之后如果不调整路线直达中心仓,也可以进行调整路线,根据订单池的<code>档口需求单</code>进行细粒度货物分配</li>
</ul>
<h3 id="基地承运单"><a href="#基地承运单" class="headerlink" title="基地承运单"></a>基地承运单</h3><p>基地采购单-&gt;装货单-&gt;调度单-&gt;承运单<br>基地承运单是直发需求,档口和中心仓直接入库无需提报物流需求单;但是服务站以订单匹配基地直发承运单的货物,服务站的货物量以当时天为单位的未完结订单为主</p>
<blockquote>
<p>数据结构</p>
</blockquote>
<p><img src="/tms-wms/index/image-02.png" width="900px"></p>
<blockquote>
<p>交互流程</p>
</blockquote>
<p><img src="/tms-wms/index/image-03.png" width="900px"></p>
<p>资料链接:https://星星.yuque.com/ngo6gg/vrcilw/mo3bvf</p>
<h2 id="4、-精准承运单"><a href="#4、-精准承运单" class="headerlink" title="4、 精准承运单"></a>4、 精准承运单</h2><p>源自草稿承运单, 一个司机多个草稿承运单串线形成最终的精准承运单 </p>
<p>草稿和精准物流单的变迁主要靠清洗路线来实现, 清洗路线的主要规则是: </p>
<p>清洗的节点按节点的时间顺序,如发车、签收时间点作为排序标准</p>
<p><img src="/tms-wms/index/image-08.png" width="700px"></p>
<p>Dispatch、RouteNode节点为主、DeliveryFee为具体的明细费用</p>
<blockquote>
<p>清洗限制条件 </p>
</blockquote>
<ul>
<li>只可对状态是配送完成的调度单进行合并。</li>
<li>来源是场内、场外虚拟仓和中心仓的调度单可以互相合并，但不能和来源是基地的调度单合并。</li>
<li>来源是基地的调度单，如果是由物流承运的可以进行相互合并；如果是由供应商承运的可以进行相互合并；承运的和供应商承运的不能进行相互合并。</li>
<li>只能对当前日期前1天的的调度单进行合并，举例：当前是8月3日，那么可以对8月2日和8月3日配送完成的调度单进行合并。</li>
<li>必须是司机姓名、司机手机号和车牌号完全一致的调度单可以合并。</li>
<li>允许多单合并。</li>
</ul>
<h2 id="5、-物流报销"><a href="#5、-物流报销" class="headerlink" title="5、 物流报销"></a>5、 物流报销</h2><p>以精准承运单进入报销流程, 报销区分基地物流费用和城配物流费用; </p>
<p>DispatchReimbursement具体的精准承运单聚合数据缓存、DispatchFee精准报销单费用明细</p>
<p>物流报销由具体的发起人、物流各级审批人、财务各级审批人、核销审批</p>
<p>发起人又细分城配物流人员、骨干物流人员, 根据不同的物流角色, 发起报销的内容也不同</p>
<p>一般基地单的骨干路线都是由骨干物流同事来发起报销、基地单的城内路线及场内还有城配产生的费用都是由城配物流同事来发起报销</p>
<blockquote>
<p>数据结构 </p>
</blockquote>
<p><img src="/tms-wms/index/image-05.png" width="700px"></p>
<p><img src="/tms-wms/index/image-06.png" width="700px"></p>
<blockquote>
<p>报销审批流程</p>
</blockquote>
<p><img src="/tms-wms/index/image-07.png" width="400px"></p>
<h2 id="6、抽检"><a href="#6、抽检" class="headerlink" title="6、抽检"></a>6、抽检</h2><p>抽检在基地直发单签收前做的一步动作,进行抽样查验货物的质量,并及时上报签收问题单发起审批</p>
<ul>
<li>品级标准: 抽样Sku的参考值</li>
<li>抽检流程: 不同Sku抽检的具体流程</li>
<li>抽检结果: 抽样后的结果,如有异常上报签问题单</li>
</ul>
<blockquote>
<p>数据结构</p>
</blockquote>
<p><img src="/tms-wms/index/image-04.png" width="700px"></p>
<p><br><br><br><br><br></p>
<h1 id="Wms"><a href="#Wms" class="headerlink" title="Wms"></a>Wms</h1><h2 id="库存点管理"><a href="#库存点管理" class="headerlink" title="库存点管理"></a>库存点管理</h2><h3 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h3><p><code>_wms_biz_instance</code> 用来表示库存点的业务场景</p>
<p>仓库点场景类型 1-档口仓；20-仓；40-加工厂仓；60-配资仓；80-冷库仓, 90–中心仓</p>
<h3 id="库存点表"><a href="#库存点表" class="headerlink" title="库存点表"></a>库存点表</h3><p><code>_wms_warehouse</code> 库存点基础信息</p>
<h3 id="库存点和外部id映射表"><a href="#库存点和外部id映射表" class="headerlink" title="库存点和外部id映射表"></a>库存点和外部id映射表</h3><p><code>_wms_warehouse_instance_relation</code> 库存点与外部站点的关联关系</p>
<h2 id="库存管理"><a href="#库存管理" class="headerlink" title="库存管理"></a>库存管理</h2><h3 id="服务站库存管理"><a href="#服务站库存管理" class="headerlink" title="服务站库存管理"></a>服务站库存管理</h3><p>服务站库存来源于:城配承运单、基地直发单</p>
<ul>
<li>城配承运单: 城配单创建之初即选择好对应的<code>服务站需求单</code>,城配单会有定时任务自动签收入库、并自动根据订单号去库存提货完结订单</li>
<li>基地直发承运单: 直发单创建之初即选定某些站点卸货的情况; 直发单在承运期间(未签收前)只要对应服务站还有待签收量,会抽对应服务站的待完结<code>服务站需求单</code>, 匹配待签收的sku进行自动签收入库, 并根据服务站需求单去库存提货完结订单<br>直发承运待签收量 &gt; 服务站需求单: 服务站需求单全都入库出库提货完结掉, 直发承运单等待新的服务站需求单到来<br>直发承运待签收量 &lt; 服务站需求单: 服务站需求单只要满足提货量的先提货掉, 如果没有满足订单的提货量先签收入库掉, 再等待新的承运单到来进行待配送的数量消耗</li>
</ul>
<h3 id="档口库存管理"><a href="#档口库存管理" class="headerlink" title="档口库存管理"></a>档口库存管理</h3><p>档口的库存来源于:城配承运单、基地直发单、场内直发单</p>
<ul>
<li>城配承运单: 城配单创建之初选择好对应的<code>档口需求单</code>, 由<code>档口店长</code>到签收列表进行<code>多、少</code>签收入库</li>
<li>基地直发承运单: 直发单创建之初即选定某些站点卸货的情况, 由<code>档口店长</code>到签收列表进行<code>多、少</code>签收入库</li>
<li>场内直发单: 场内直发单创建之初只选对一个中心仓为卸货站点, 后期经过调整路线转到具体的档口, 由<code>档口店长</code>到签收列表进行<code>多、少</code>签收入库</li>
</ul>
<h3 id="中心仓库存管理"><a href="#中心仓库存管理" class="headerlink" title="中心仓库存管理"></a>中心仓库存管理</h3><p>中心仓的库存来源于:城配承运单、基地直发单、场内直发单</p>
<ul>
<li>城配承运单: 城配单创建之初选择好对应的<code>档口需求单</code>, 由<code>城配物流</code>到签收列表进行<code>多、少</code>签收入库</li>
<li>基地直发承运单: 直发单创建之初即选定某些站点卸货的情况, 由<code>城配物流</code>到签收列表进行<code>多、少</code>签收入库</li>
<li>场内直发单: 场内直发单创建之初只选对一个中心仓为卸货站点, 后期经过调整路线转到具体的中心仓, 由<code>城配物流</code>到签收列表进行<code>多、少</code>签收入库</li>
</ul>
<h3 id="上游wms库存管理（待接入）"><a href="#上游wms库存管理（待接入）" class="headerlink" title="上游wms库存管理（待接入）"></a>上游wms库存管理（待接入）</h3><h2 id="档口拆包"><a href="#档口拆包" class="headerlink" title="档口拆包"></a>档口拆包</h2><blockquote>
<p>商品拆包映射（档口自己管理，wms提供库存转换接口，内部调用出入库接口）</p>
</blockquote>
<p>档口拆包: 档口店主或员工根据签收的Sku,可能要从一件货比如30斤拆成新的Sku(细粒度的货物),再进行售卖</p>
<p>原先的档口拆包只有在签收的时候进行,现在的档口拆包途径只有在库存中进行;先签收入库到档口库存,后期再根据售卖情况进行合理的拆分;</p>
<h2 id="锁定库存"><a href="#锁定库存" class="headerlink" title="锁定库存"></a>锁定库存</h2><h3 id="档口下单"><a href="#档口下单" class="headerlink" title="档口下单"></a>档口下单</h3><p>下单锁定库存，支付的时候会释放库存</p>
<h3 id="库存盘点"><a href="#库存盘点" class="headerlink" title="库存盘点"></a>库存盘点</h3><p>每次发起库存盘点,将对盘点的库存进行锁定操作</p>
<h2 id="操作记录"><a href="#操作记录" class="headerlink" title="操作记录"></a>操作记录</h2><blockquote>
<p>操作记录-&gt;流水记录-&gt;库存记录</p>
</blockquote>
<ul>
<li>操作记录的业务类型和业务Id可以溯源具体的出库入库业务场景</li>
<li>流水记录的操作类型说明是出库还是入库类型</li>
</ul>
<p><img src="/tms-wms/index/image-01.png" width="900px"></p>
<h2 id="批次号"><a href="#批次号" class="headerlink" title="批次号"></a>批次号</h2><blockquote>
<p>入库、出库对批次号的变化影响</p>
</blockquote>
<p><img src="/tms-wms/index/image-10.png" width="700px"></p>
<p>发车时创建一阶批次，一阶批次每次被签收时，创建一个二阶批次;<br>二阶批次每次被发车时，创建一个三阶批次;<br>三阶批次每次被签收时，创建一个四阶批次……以此类推;<br>每次发车和签收时，都会创建一个新批次。上一阶批次和下一阶批次的关系是1:n。</p>
<p>当签收时同一物流单、同一SKU出现多个批次，且此时如果缺货或多收,则对第一个批次做相应的多件数,对最后一次批次做少件数</p>
<h2 id="库存盘点-1"><a href="#库存盘点-1" class="headerlink" title="库存盘点"></a>库存盘点</h2><h3 id="档口盘点"><a href="#档口盘点" class="headerlink" title="档口盘点"></a>档口盘点</h3><ul>
<li>1.涉及应用：档口宝app</li>
<li>2.盘点流程：<ul>
<li>(1) 档口宝发起盘点</li>
<li>(2) wms库存变更</li>
<li>(3) 若为盘亏，则同时向logistics-service模块发送mq，根据审批链生成审批单</li>
</ul>
</li>
</ul>
<blockquote>
<p>档口审批单流向<br>档口人员发起盘点:店长、店员、运营经理</p>
</blockquote>
<ul>
<li>1）盘亏金额＜500元 <pre><code>A、档口所关联店员、店长角色发起，流转档口所关联运营经理角色审批；
B、档口所关联运营经理发起，审批单仍然需要运营经理审批（录入处理意见）；
</code></pre></li>
<li>2）500元≤盘亏金额<pre><code>A、档口所关联店员、店长角色发起，流转档口所关联运营经理、城市总角色逐层审批；
B、档口所关联运营经理发起，流转档口所关联城市总角色审批；
</code></pre></li>
</ul>
<h3 id="中心仓盘点"><a href="#中心仓盘点" class="headerlink" title="中心仓盘点"></a>中心仓盘点</h3><ul>
<li>1.涉及应用：erp</li>
<li>2.盘点流程：<ul>
<li>(1) erp发起盘点</li>
<li>(2) wms库存变更</li>
<li>(3) 若为盘亏，则同时向logistics-service模块发送mq，根据审批链生成审批单</li>
</ul>
</li>
</ul>
<blockquote>
<p>erp审批单流向</p>
</blockquote>
<pre><code>【物流人员发起盘点】（审批流后续附件提供）
</code></pre><ul>
<li>1）盘亏金额＜1000元 时流转到一级、二级审批人审批；</li>
<li>2）1000元≤盘亏金额 时，流转到三级审批人审批；</li>
</ul>
<p><br><br><br><br><br></p>
<h1 id="物流调整路线"><a href="#物流调整路线" class="headerlink" title="物流调整路线"></a>物流调整路线</h1><h2 id="调整初始化-拆单"><a href="#调整初始化-拆单" class="headerlink" title="调整初始化(拆单)"></a>调整初始化(拆单)</h2><img src="http://www.plantuml.com/plantuml/svg/IqmkoIzIU3vbnREExLnS45hNxdddocTR6v_DwNtQjT1AuTdyfI_MBtgwT_BJpjvddVjVx9_mj7VgyxuDpxksMHKdPwIcbEPavgLxfd0XQyCmP6FxiuRTnTcbpvfRdxPj9KBjyzKpdpVjnAuSx4uhXUUx9p-RD-VfngdFb-pYoiilILN8BqijKiXFKq1MprMjXEnC9QkAYWeTBawbelpIabIN4FzWgsWkJaxEQeW0J862Kav-Sc99PduUJ0Gku9UOcmeLAix8BtT9pKajINNBIKm72zO23Oi5cG_qBCXq9PZnG3x2y9JKd4oWMolzIdDXGgLvEVc9AJvGIroW2Y16A83D09c2gWfX8AeumebOhIhEJC-3SK7kvOm5kxgMApKlHG4Ka5m0">
<h2 id="调线流程-拆单"><a href="#调线流程-拆单" class="headerlink" title="调线流程(拆单)"></a>调线流程(拆单)</h2><img src="http://www.plantuml.com/plantuml/svg/lPFDJjj058NNdgUml4wbGdyMNbHgwOPDkmYxgeieSKDKQhTfNAL2aKp0IGnOiGI8WAoc5BU1LgG1yMCIK5x6S-syHQyP9xBIAigg6ylZEVVSUxuPfz859S_xsqTGk-89aPM2n2kVf3ollE5zunWkLi0swVe1MHO-fXUbZBgKaxFp6K4KYiMYa22Sa5VKWZGlvmhF5ruc1V4LuPQ59IMTAkGKEHIYBY6aK_ciChUOahFImkVtaY3E9AB2c1KNcINVgZ4_R8pheH6-lr3V2U9iwNNaa9G-g9AS3ZrBYV_J_34s7-kDyvI896Vua21XFEyzYHCKUQXRNjU1ZGerTmQs1gTb4XUCoscz33kTmRSrEDIW-Nt2sSo8J4AjJS_LFFUd_slFBrzxD_kUQ-8JR6DGDQbZOW0o6udPDFx-sbsIaPO9cG5v8CA90qO_w5iuCpH-K-i7FMbG-uWy7D_2yb3Gx5Ax4tuns-JHlyglplnUVQ2R0ss5jZUXPiMmJQ01hWxdkx3x5Tb6y2O12VfLw3d1eHwSjuBrCeR1f1W_wApYaaSAz7QB6YOrNLImk3WQ2pSQsNEtsOm8otUwzFgI-I8Ozi9ot4Tll3V8X7s5iuCG-TqUziJTU9lfylfsaxQ_iAJJN83JAcWzbWaC3TkplE4DgjOZz2pAC1oRBnAiwhHoGRYd4PQmCdRQh8PmpyQtWqizZ6nhr6anFpGZtDnVkdu3HwB6iNUx5tKSCiAffYD2RpJQsWX_drfb0ekHsHy0">
<blockquote>
<p>req、reqDetail、batchNo、shipmentDetail 、skuId、locationId</p>
</blockquote>
<img src="http://www.plantuml.com/plantuml/svg/Iyv9B2vMU3cduTd6fgUzKwkvE8jI2wt1f4jgIM9cZZLNBHTNCbZLYyMjBxOiXwWgpiWio4tDA_5CiKPm83f0Gd0zBrjxNpOqFc_Q2TIJav-SM9APduUYu5dd_XVx9ppjtO4mEhiKR6fIOaboXby-XjfdKpSywrttVFVaP_FcA83K9sUaffJcPEQbWxLXk1zX49f3hH5s8JkDCoKr9xCijQZIhpGNf2GpFG_C0Zg32uiBR7Hr4U67Im6QBt6Q0mijN0hWKG00">
<p>装货子单为一个采购子单域下</p>
<p>同一个批次号可能有不同的装货单组成,同一个装货单一定是相同批次号</p>
<blockquote>
<p>数据合并和切割 </p>
</blockquote>
<p>以装货单最细粒度去划分数量分配情况;</p>
<blockquote>
<p>以上数据结构可能需要变迁的数据情况 </p>
</blockquote>
<ul>
<li>线路节点:route、route_record</li>
<li>卸货单:unload_cargo</li>
<li>Sku批次数据:node_distribution、node_distribution_detail</li>
</ul>

        
    </section>
</article>



<div class="comments">
    <div id="disqus_thread">
        <p class="comment-tips">国内查看评论需要代理~</p>
    </div>
    <script>
    window.disqus_config = function () {
        this.language = 'zh';
        this.page.url = 'http://www.coderss.cn/tms-wms/index.html';
        this.page.title = '物流仓储分享';
        this.page.identifier = 'tms-wms/index.html';
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://name.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>
</footer>

<script type="text/javascript" src="//s13.cnzz.com/z_stat.php?id=1234567890&amp;web_id=1234567890"></script>


    </div>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    
    <script type="text/javascript">
        $(function() {
            var nodes = {
                nav: $('#nav'),
                aside: $('#aside'),
                navTags: $('#nav-tags')
            };

            $('#open-panel, #aside-mask').on('click', function() {
                nodes.aside.toggleClass('panel-show');
            });
            $('#nav-tag').on('click', function(event) {
                event.preventDefault();console.log(nodes.navTags.attr('class'))
                nodes.navTags.toggleClass('tag-show');console.log(nodes.navTags.attr('class'))
            })/*.hover(function() {
                nodes.navTags.addClass('tag-show');
            }, function() {
                nodes.navTags.removeClass('tag-show');
            });*/

            
        });
    </script>

</body>
</html>
